<input #myInput name="imageUrl" style="display: none;" id="imageUrl" class="form-control" type="file" accept="image/*"
    (change)="handleInputChange($event)" multiple capture="environment" />

<link rel="stylesheet"
    href="https://fonticons-free-fonticons.netdna-ssl.com/kits/349cfdf6/publications/117298/woff2.css" media="all">

<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-8">
                    <qrcode *ngIf="order?.number > 0" [qrdata]="host+'order/upload/'+order.businessUid+'/'+order.uid"
                        style="float: left;margin-right: 10px;" [width]="120" [errorCorrectionLevel]="'L'"></qrcode>
                    <h1 class="m-0">Ordem de Serviço {{order.number
                        > 0 ? 'Nº ' + order.number :
                        ''}}</h1>
                </div><!-- /.col -->
                <div class="col-sm-4">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Ordem</a></li>
                        <li class="breadcrumb-item active">Dashboard v1</li>
                    </ol>
                </div><!-- /.col -->
            </div><!-- /.row -->
        </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->
    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <!-- left column -->
                <div class="col-md-12">
                    <!-- jquery validation -->
                    <div class="card card-primary">
                        <!-- /.card-header -->
                        <!-- form start -->
                        <div class="card-outline card-outline-tabs">
                            <div class="card-header p-0 border-bottom-0">
                                <ul class="nav nav-tabs" id="custom-tabs-four-tab" role="tablist">
                                    <li class="nav-item ">
                                        <a class="nav-link active" id="custom-tabs-four-order-tab" data-toggle="pill"
                                            href="#custom-tabs-four-order" role="tab"
                                            aria-controls="custom-tabs-four-order" aria-selected="true">Ordem</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="custom-tabs-four-service-tab" data-toggle="pill"
                                            href="#custom-tabs-four-service" role="tab"
                                            aria-controls="custom-tabs-four-service" aria-selected="false">Produtos e
                                            Serviços</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="custom-tabs-docs-tab" data-toggle="pill"
                                            href="#custom-tabs-docs" role="tab" aria-controls="custom-tabs-docs"
                                            aria-selected="false">Documentos</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="custom-tabs-images-tab" data-toggle="pill"
                                        href="#custom-tabs-images" role="tab" aria-controls="custom-tabs-images"
                                        aria-selected="false">Fotos</a>
                                    </li>
                                    <li class="nav-item" *ngIf="business.showProductInputs">
                                        <a class="nav-link" id="custom-tabs-insumos-tab" data-toggle="pill"
                                            href="#custom-tabs-insumos" role="tab"
                                            aria-controls="custom-tabs-insumos-order" aria-selected="false">Insumos</a>
                                    </li>
                                    <li class="nav-item" *ngIf="business.showTaximeter">
                                        <a class="nav-link" id="custom-tabs-taximetro-tab" data-toggle="pill"
                                            href="#custom-tabs-taximetro" role="tab"
                                            aria-controls="custom-tabs-taximetro-order"
                                            aria-selected="false">Taximetro</a>
                                    </li>
                                </ul>
                            </div>
                            <div class="card-body">
                                <div class="tab-content" id="custom-tabs-four-tabContent">
                                    <div class="tab-pane fade show active" id="custom-tabs-four-order" role="tabpanel"
                                        aria-labelledby="custom-tabs-four-order-tab">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="type"
                                                        style="float: left;margin-right: 10px;">Tipo</label>
                                                    <br>
                                                    <select id="type" name="type" class="form-control"
                                                        [(ngModel)]="order.type" placeholder='Selecione o tipo da OS'>
                                                        <option *ngFor="let d of types" [value]="d.nameInternal">
                                                            {{d.name}}
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group" *ngIf="false">
                                                    <label for="type"
                                                        style="float: left;margin-right: 10px;">Checklist</label>
                                                    <br>
                                                    <select id="checklistUid" name="checklistUid" class="form-control"
                                                        [(ngModel)]="order.checklistUid"
                                                        placeholder='Selecione um Checklist'>
                                                        <option *ngFor="let d of checklists" [value]="d.uid">
                                                            {{d.number}} - {{d.plate}}
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="client"
                                                        style="float: left;margin-right: 10px;">Cliente</label>
                                                    <h3 data-toggle="modal" data-target="#modal-new-user"
                                                        class="card-title card-button">
                                                        <i class="fas fa-user-plus" data-toggle="tooltip"
                                                            data-placement="top" title="Cadastrar Novo Cliente"
                                                            style="cursor: pointer;"></i>
                                                    </h3>
                                                    <h3 *ngIf="order.clientUid" class="card-title card-button"
                                                        style="margin-left: 10px;">
                                                        <i class="fa-solid fa-pen-to-square" style="cursor: pointer;"
                                                            data-placement="top" title="Editar Cliente"
                                                            (click)="editPerson(1,true)"></i>
                                                    </h3>
                                                    <h3 class="card-title card-button" style="margin-left: 10px;">
                                                        <i class="fas fa-search" style="cursor: pointer;"
                                                            data-placement="top" title="Pesquisar"
                                                            (click)="getAllPerson(1,true)"></i>
                                                    </h3>

                                                    <br>
                                                    <ng-select id="client" name="client" [(ngModel)]="order.clientUid"
                                                        placeholder='Selecione o Cliente'
                                                        (ngModelChange)="verifyClient()">
                                                        <ng-option *ngFor="let d of clients" [value]="d.uid">
                                                            {{d.nameCompany}} {{d.cnpjCpf | mask: 'CPF_CNPJ'}} -
                                                            {{((d.phone1 !== undefined && d.phone1 !== '') ? (d.phone1 |
                                                            mask: '(00) 0 0000-0000') : '')}}
                                                            - <br><small><b>{{d.nameFantasy}}</b></small>
                                                            <small style="display: none;">{{d.phone1}}
                                                                {{d.cnpjCpf}}</small>
                                                        </ng-option>
                                                    </ng-select>
                                                    <label style="color: red; font-size: small;"
                                                        *ngIf="this.debt">*Cliente
                                                        inadimplente</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="form-group col-3">
                                                <label for="plate" style="float: left;margin-right: 10px;">Placa</label>
                                                <br>
                                                <input type="text" name="plate" id="plate" class="form-control"
                                                    [(ngModel)]="order.plate" placeholder="Entre com a placa"
                                                    mask="AAA AAAA" (change)="getPlate()">
                                            </div>
                                            <div class="form-group col-3">
                                                <label for="plate" data-toggle="offcanvas" role="button"
                                                    data-tooltip="tooltip"
                                                    title="Usar quando não houver placa">Equipamento</label>
                                                <input type="text" name="device" id="device" class="form-control"
                                                    [(ngModel)]="order.device" placeholder="Equipamento" maxlength="50">
                                            </div>
                                            <div class="form-group col-3">
                                                <label for="km">Km inicial</label>
                                                <input type="text" name="km" id="km" class="form-control" currencyMask
                                                    [options]="{ allowNegative: false ,align:'left', prefix: '', precision: 0, suffix: 'Km', thousands: '.', decimal: ',' }"
                                                    [(ngModel)]="order.startKm" placeholder="Entre com o km inicial">
                                            </div>
                                            <div class="form-group col-3">
                                                <label for="plate">Chassi</label>
                                                <input type="text" name="chassi" id="chassi" class="form-control"
                                                    [(ngModel)]="order.chassi" placeholder="Entre com o chassi"
                                                    maxlength="17">
                                            </div>
                                            <div class="form-group col-3">
                                                <label for="km">Marca</label>
                                                <input type="text" name="brand" id="brand" class="form-control"
                                                    [(ngModel)]="order.brand" placeholder="Entre com o marca" />
                                            </div>
                                            <div class="form-group col-3">
                                                <label for="km">Modelo</label>
                                                <input type="text" name="model" id="model" class="form-control"
                                                    [(ngModel)]="order.model" placeholder="Entre com o modelo" />
                                            </div>
                                            <div class="form-group col-3">
                                                <label for="expire"><b>Data de Entrada</b></label>
                                                <input type="datetime-local" name="dateCarArrival" id="dateCarArrival"
                                                    class="form-control"
                                                    [ngModel]="order.dateCarArrival | date:'yyyy-MM-dd HH:mm'"
                                                    (ngModelChange)="order.dateCarArrival = $event">
                                            </div>
                                            <div class="form-group col-3">
                                                <label for="expire"><b>Previsão de Entrega</b></label>
                                                <input type="datetime-local" name="deadline" id="deadline"
                                                    class="form-control"
                                                    [ngModel]="order.deadline | date:'yyyy-MM-dd HH:mm'"
                                                    (ngModelChange)="order.deadline = $event">
                                            </div>
                                            <div class="form-group col-3">
                                                <label for="expire">Cor:</label>
                                                <input type="text" name="color" id="color" class="form-control"
                                                    [(ngModel)]="order.color" maxlength="50">
                                            </div>
                                            <div class="form-group col-3">
                                                <label for="expire">Ano:</label>
                                                <input type="text" name="year" id="year" class="form-control"
                                                    [(ngModel)]="order.year" maxlength="50">
                                            </div>
                                            <div class="form-group col-3">
                                                <label for="expire">Motor:</label>
                                                <input type="text" name="motor" id="motor" class="form-control"
                                                    [(ngModel)]="order.motor" maxlength="50">
                                            </div>

                                            <div class="form-group col-3">
                                                <label for="expire">Combustível:</label>
                                                <input type="text" name="fuel" id="fuel" class="form-control"
                                                    [(ngModel)]="order.fuel" maxlength="50">
                                            </div>

                                            <div class="form-group col-4">
                                                <label for="expire">Observação do Veiculo:</label>
                                                <input type="text" name="motorNote" id="motorNote" class="form-control"
                                                    [(ngModel)]="order.motorNote" maxlength="50" readonly>
                                            </div>

                                            <div class="form-group col-4">
                                                <label for="expire">Informações de Pagamento:</label>
                                                <input type="text" name="descriptionPay" id="descriptionPay"
                                                    class="form-control" [(ngModel)]="order.descriptionPay"
                                                    maxlength="255">
                                            </div>

                                            <div class="form-group col-4">
                                                <label for="technicianUid"
                                                    style="float: left;margin-right: 10px;">Consultor
                                                    Responsável</label>
                                                <br>
                                                <ng-select id="technicianUid" name="technicianUid"
                                                    [(ngModel)]="order.technicianUid"
                                                    placeholder='Selecione o Técnico Responsável'>
                                                    <ng-option *ngFor="let d of salesMan" [value]="d.uid">
                                                        {{d.nameCompany}} {{d.cnpjCpf | mask: 'CPF_CNPJ'}} </ng-option>
                                                </ng-select>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="client"
                                                        style="float: left;margin-right: 10px;">CheckList</label>
                                                    <h3 data-toggle="modal" data-target="#modal-new-Check"
                                                        class="card-title card-button">
                                                        <i class="fas fa-user-plus" data-toggle="tooltip"
                                                            data-placement="top" title="Cadastrar Novo CheckList"
                                                            style="cursor: pointer;"></i>
                                                    </h3>
                                                    <h3 *ngIf="order.clientUid" class="card-title card-button"
                                                        style="margin-left: 10px;">
                                                        <i class="fa-solid fa-pen-to-square" style="cursor: pointer;"
                                                            data-placement="top" title="Editar CheckList"
                                                            (click)="editCheckList(1,true)"></i>
                                                    </h3>

                                                    <br>
                                                    <ng-select id="client"  name="client" [(ngModel)]="order.checklistUid
                                                        placeholder='Selecione o Checklist'
                                                        (ngModelChange)="verifyClient()">
                                                        <ng-option *ngFor="let d of clients" [value]="d.uid">
                                                            {{d.nameCompany}} {{d.cnpjCpf | mask: 'CPF_CNPJ'}} -
                                                            {{((d.phone1 !== undefined && d.phone1 !== '') ? (d.phone1 |
                                                            mask: '(00) 0 0000-0000') : '')}}
                                                            - <br><small><b>{{d.nameFantasy}}</b></small>
                                                            <small style="display: none;">{{d.phone1}}
                                                                {{d.cnpjCpf}}</small>
                                                        </ng-option>
                                                    </ng-select>
                                                    <label style="color: red; font-size: small;"
                                                        *ngIf="this.debt">*Cliente
                                                        inadimplente</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="description">Descrição Complementar</label>
                                            <textarea class="form-control" rows="5" type="text" name="description"
                                                id="description" maxlength="1000"
                                                placeholder="Entre com a descrição detalhada da ordem"
                                                [(ngModel)]="order.description"></textarea>
                                            <label style="font-size: 12px;">Total de caracteres restantes:
                                                {{(order.description != null ? 1000-order.description?.length:
                                                1000)}}</label>
                                        </div>

                                        <div class="form-group">
                                            <label for="internalCommentary">Comentário interno</label>
                                            <textarea class="form-control" rows="5" type="text"
                                                name="internalCommentary" id="internalCommentary" maxlength="1000"
                                                placeholder="Entre com o comentário interno da ordem"
                                                [(ngModel)]="order.internalCommentary"></textarea>
                                            <label style="font-size: 12px;">Total de caracteres restantes:
                                                {{(order.internalCommentary != null ?
                                                1000-order.internalCommentary?.length:
                                                1000)}}</label>
                                        </div>

                                        <div class="form-group" *ngIf="this.edit">
                                            <div class="form-group col-12" style="min-height: 80px;" *ngIf="photosUrl.length === 1 || photosUrl.length === 0">
                                                <label class="col-md-3 fontCenter" style="cursor: pointer;" 
                                                    for="imageUrl">
                                                    <div class="col-md-12 divImage"
                                                        [hidden]="photosUrl.length > 0">
                                                        <div class="col-md-12 divImage"><i
                                                                class="fas fa-images fontAwesome"></i></div>
                                                        <div class="col-md-12 divImage">Clique aqui para escolher
                                                            uma foto
                                                        </div>
                                                    </div>

                                                    <img
                                                        class="col-12"
                                                        [src]="photosUrl[0]?.base64"
                                                        style="max-width:100%; max-height:100%; object-fit: cover;"
                                                    />

                                                </label>

                                                <div class="col-md-9" style="float: left;">
                                                    <label for="descriptionp">Descrição:</label>
                                                    <textarea type="text" name="name" id="descriptionp"
                                                        class="form-control" placeholder="Descrição"
                                                        [(ngModel)]="orderMedia.description" maxlength="220"
                                                        rows="5"></textarea>
                                                    <label style="font-size: 12px;">Total de caracteres restantes:
                                                        {{(orderMedia.description != null ?
                                                        220-orderMedia.description?.length:
                                                        220)}}</label>
                                                </div>
                                                <div class="col-12" style=" margin-bottom:10px; float: right;">
                                                    <button class="btn btn-primary" style="float: right;"
                                                        (click)="savePhotoArray('img')">Adicionar Foto</button>
                                                </div>
                                            </div>
                                            <div *ngIf="photosUrl.length > 1" class="form-group col-12" >
                                                <div class="form-group row mb-3" style="min-height: 80px;" *ngFor="let photo of photosUrl">
                                                    <label class="col-md-3 fontCenter" style="cursor: pointer;"
                                                        for="imageUrl">
                                                        <img
                                                            class="col-12"
                                                            [src]="photo.base64"
                                                            style="max-width:100%; max-height:100%; object-fit: cover;"
                                                        />

                                                    </label>

                                                    <div class="col-md-9" style="float: left;">
                                                        <label for="descriptionp">Descrição:</label>
                                                        <textarea type="text" name="name" id="descriptionp"
                                                            class="form-control" placeholder="Descrição"
                                                            [(ngModel)]="photo.description" maxlength="220"
                                                            rows="5"></textarea>
                                                        <label style="font-size: 12px;">Total de caracteres restantes:
                                                            {{(photo.description != null ?
                                                            220-photo.description?.length:
                                                            220)}}</label>
                                                    </div>
                                                </div>
                                                <div class="col-12" style=" margin-bottom:10px; float: right;">
                                                    <button class="btn btn-primary" style="float: right;"
                                                        (click)="savePhotoArray('img')">Adicionar Fotos</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <table id="example1" class="table table-bordered table-striped">
                                                <thead>
                                                    <tr>
                                                        <th>Fotos</th>
                                                        <th>Descrição</th>
                                                        <th>Momento</th>
                                                        <th style="text-align: center;" *ngIf="this.edit">Ações</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let pt of order.orderMedias"
                                                        style="{{pt.type !== 'img' ? 'display:none' : ''}}">

                                                        <td style="text-align: center;">
                                                            <img-minio [fileName]="pt.name"
                                                                [style]="'max-width: 100px'"></img-minio>
                                                        </td>
                                                        <td>
                                                            {{pt.description}}
                                                        </td>
                                                        <td>
                                                            {{pt.moment === 0 ? 'CheckIn' : pt.moment === 1 ? 'Checkout' : 'Em andamento'}}
                                                        </td>
                                                        <td style="text-align: center;" *ngIf="this.edit">
                                                            <i class="fas fa-trash-alt btnAction"
                                                                (click)="onRemove(pt)"></i>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="custom-tabs-four-service" role="tabpanel"
                                        aria-labelledby="custom-tabs-four-service-tab">
                                        <app-order-product-add id="service" [visible]="this.edit"
                                            (newOrderProduct)="addSize($event)">
                                        </app-order-product-add>

                                        <div class="row">
                                            <table id="example1" class="table table-bordered table-striped"
                                                cellspacing="0" id="excel-export">
                                                <thead>
                                                    <tr *ngIf="order.orderOutSourcing === undefined">
                                                        <th colspan="11" style="padding: 0px;">
                                                            <table cellspacing="0" style="width: 100%;">
                                                                <thead>
                                                                    <tr>
                                                                        <td colspan="2">
                                                                            <h3 (click)="exportexcel()"
                                                                                class="card-title card-button"
                                                                                style="float:right;cursor: pointer;">
                                                                                <i
                                                                                    class="fas fa-thin fa-file-excel"></i>
                                                                            </h3>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td
                                                                            style="text-align: right;width: 70%; padding-top: 10px;">
                                                                            Direcionar a forma de desconto
                                                                        </td>
                                                                        <td>
                                                                            <select id="type" name="type"
                                                                                class="form-control"
                                                                                [(ngModel)]="typeDiscount"
                                                                                placeholder=''>
                                                                                <option *ngFor="let d of typesDiscount"
                                                                                    [value]="d">
                                                                                    {{d}}
                                                                                </option>
                                                                            </select>
                                                                        </td>
                                                                    </tr>
                                                                    <tr
                                                                        *ngIf="order.orderOutSourcing === undefined && discountPermission">
                                                                        <td style="text-align: right;width: 70%;">
                                                                            Desconto Geral por %
                                                                        </td>
                                                                        <td
                                                                            style="text-align: center;width: 30%;padding: 0px;">
                                                                            <input type="text" name="discountGeneral"
                                                                                id="discountGeneral"
                                                                                class="form-control" currencyMask
                                                                                max="100" min="0"
                                                                                (blur)="changeDiscount($event)"
                                                                                [(ngModel)]="discountGeneral"
                                                                                [options]="{ align:'right', thousands: '.', prefix: '% ', decimal: ',', allowNegative: 'false'}" />
                                                                        </td>

                                                                    </tr>
                                                                    <tr
                                                                        *ngIf="order.orderOutSourcing === undefined && discountPermission">
                                                                        <td style="text-align: right;width: 70%;">
                                                                            Desconto Geral por R$
                                                                        </td>
                                                                        <td
                                                                            style="text-align: center;width: 30%;padding: 0px;">
                                                                            <input type="text"
                                                                                name="discountGeneralPrice"
                                                                                id="discountGeneralPrice"
                                                                                class="form-control" currencyMask
                                                                                max="100" min="0"
                                                                                (blur)="changeDiscountPrice($event)"
                                                                                [(ngModel)]="discountGeneralPrice"
                                                                                [options]="{ align:'right', thousands: '.', prefix: 'R$ ', decimal: ',', allowNegative: 'false'}" />
                                                                        </td>
                                                                    </tr>
                                                                </thead>
                                                            </table>
                                                        </th>
                                                    </tr>
                                                    <tr>
                                                        <th>Produto</th>
                                                        <th style="text-align: center; max-width: 50px;">Entrega</th>
                                                        <th style="text-align: center; max-width: 90px;">Frete</th>
                                                        <th style="text-align: center; max-width: 90px;">Qtd</th>
                                                        <th style="text-align: center; max-width: 90px;">Custo Unit.
                                                            R$
                                                        </th>
                                                        <th style="text-align: center; max-width: 90px;">Valor Unit.
                                                            R$
                                                        </th>
                                                        <th style="text-align: center; max-width: 90px;">Desc Unit.
                                                            R$</th>
                                                        <th style="text-align: center; max-width: 90px;">Total R$
                                                        </th>
                                                        <th style="text-align: center; max-width: 50px;">Pós
                                                        </th>
                                                        <th style="text-align: center;width: 15%;"><i
                                                                (click)="repeatTechnician()" class="fa-solid fa-repeat"
                                                                style="cursor: pointer;"></i>
                                                            Técnico</th>
                                                        <th style="text-align: center;" *ngIf="this.edit">Ações</th>
                                                    </tr>
                                                </thead>
                                                <tbody>

                                                    <ng-container
                                                        *ngFor="let ss of servicess | productTypeFilter:1; let i = index">
                                                        <!-- Linha principal -->
                                                        <tr>

                                                            <td data-toggle="tooltip" data-placement="top"
                                                                title="{{ss.product?.localStorage?.toUpperCase()}}">
                                                                <b>{{ss.product?.codeManufacturer}}</b> -
                                                                {{ss.product?.code}} -
                                                                {{ss.productName}}
                                                                <br />
                                                                <small *ngIf="ss.from != undefined">Fornecimento:
                                                                    {{ss.from}}</small>
                                                            </td>
                                                            <td style="text-align: center;">
                                                                <input type="checkbox" [name]="'dateDelivery' + ss.uid "
                                                                    [id]="'dateDelivery' + ss.uid"
                                                                    [disabled]="!warehouseProfile" 
                                                                    [(ngModel)]="ss.warehouse">
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;">
                                                                <input type="text" [name]="'shippingValue' + ss.uid "
                                                                    [id]="'shippingValue' + ss.uid" class="form-control"
                                                                    [(ngModel)]="ss.shippingValue"
                                                                    placeholder="Entre com a Frete" currencyMask
                                                                    [options]="{ align:'right', thousands: '.', prefix: '', decimal: ',', allowNegative: 'false'}">
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="ss.productDiscount > 0">
                                                                {{ss.quantity | number:'1.2-2' }}
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="ss.productDiscount == 0">
                                                                <input type="text" [name]="'quantity' + ss.uid "
                                                                    [id]="'quantity' + ss.uid" class="form-control"
                                                                    [(ngModel)]="ss.quantity"
                                                                    placeholder="Entre com a quantidade" currencyMask
                                                                    [options]="{ align:'right', thousands: '.', prefix: '', decimal: ',', allowNegative: 'false'}">
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;">
                                                                <input type="text" [name]="'productPriceCost' + ss.uid "
                                                                    *ngIf="ss.productType === 2 || viewCost"
                                                                    [id]="'productPriceCost' + ss.uid"
                                                                    class="form-control"
                                                                    [(ngModel)]="ss.productPriceCost" currencyMask
                                                                    [options]="{ align:'right', thousands: '.', prefix: '', decimal: ',', allowNegative: 'false'}">
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="ss.productDiscount > 0">
                                                                {{ss.productPrice | number:'1.2-2' }}
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="ss.productDiscount == 0">
                                                                <input type="tel" [name]="'prices' + ss.uid "
                                                                    [id]="'prices' + ss.uid" class="form-control"
                                                                    [(ngModel)]="ss.productPrice" currencyMask
                                                                    [readOnly]="changePrice"
                                                                    [options]="{ align:'right', thousands: '.', prefix: 'R$', decimal: ',', allowNegative: 'false'}" />
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="order.orderOutSourcing === undefined">
                                                                <div *ngIf="ss.productDiscountPercentual">
                                                                    {{(ss.productDiscountPercentual ?
                                                                    (ss.productDiscount |
                                                                    number:'1.2-2')
                                                                    + '%' : 'R$ ' + (ss.productDiscount |
                                                                    number:'1.2-2')
                                                                    )}}
                                                                </div>

                                                                <input *ngIf="!ss.productDiscountPercentual" type="text"
                                                                    [name]="'productDiscount' + ss.uid "
                                                                    [id]="'productDiscount' + ss.uid"
                                                                    class="form-control"
                                                                    [(ngModel)]="ss.productDiscount" currencyMask
                                                                    (blur)="discountChange(ss)"
                                                                    [options]="{ align:'right', thousands: '.', prefix: 'R$', decimal: ',', allowNegative: 'false'}" />
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="order.orderOutSourcing !== undefined">
                                                                <input type="text" [name]="'productDiscount' + ss.uid "
                                                                    [id]="'productDiscount' + ss.uid"
                                                                    class="form-control"
                                                                    [(ngModel)]="ss.productDiscount" currencyMask
                                                                    (blur)="discountChange(ss)"
                                                                    [options]="{ align:'right', thousands: '.', prefix: 'R$', decimal: ',', allowNegative: 'false'}" />
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;">
                                                                <b>{{total(ss) | number:'1.2-2'}}</b>
                                                            </td>
                                                            <td style="text-align: end;max-width: 90px;">
                                                                <input type="number" [name]="'frequency' + ss.uid "
                                                                    [id]="'frequency' + ss.uid" class="form-control"
                                                                    [(ngModel)]="ss.frequency"
                                                                    placeholder="Entre com a quantidade dias">
                                                            </td>
                                                            <td style="padding: 0px;">
                                                                <ng-select id="technicianUid-{{ss.uid}}"
                                                                    (change)="changeTechnician(ss)" name="technicianUid"
                                                                    [(ngModel)]="ss.technicianUid" appendTo="body"
                                                                    placeholder='Técnico'>
                                                                    <ng-option *ngFor="let d of technicals"
                                                                        [value]="d.uid">
                                                                        {{d?.nameCompany?.split(' ')[0]}}
                                                                        {{(d?.nameCompany?.split(' ')[1] !==
                                                                        undefined ?
                                                                        d?.nameCompany?.split(' ')[1] : '')}}
                                                                        <!-- {{d.cnpjCpf | mask:
                                                                    'CPF_CNPJ'}} -->
                                                                    </ng-option>
                                                                </ng-select>
                                                            </td>
                                                            <td style="text-align: center;">
                                                                <i class="fas fa-arrow-alt-circle-up btnAction"
                                                                    *ngIf="expandedRow === i"
                                                                    (click)="toggleExpand(i)">&nbsp;</i>

                                                                <i class="fas fa-arrow-alt-circle-down btnAction"
                                                                    *ngIf="expandedRow !== i"
                                                                    (click)="toggleExpand(i)">&nbsp;</i>

                                                                <i class="fas fa-trash-alt btnAction"
                                                                    (click)="delete(ss)" *ngIf="this.edit"></i>&nbsp;
                                                                <i class="fas fa-thumbs-down btnAction"
                                                                    *ngIf="!ss.approved"
                                                                    (click)="this.edit ? ss.approved = true : return"
                                                                    data-toggle="tooltip" data-placement="top"
                                                                    title="Não Aprovado" style="color: red;"></i>
                                                                <i class="fas fa-thumbs-up btnAction"
                                                                    *ngIf="ss.approved" (click)="notApproved(ss)"
                                                                    data-toggle="tooltip" data-placement="top"
                                                                    title="Aprovado" style="color: green;"></i>
                                                            </td>

                                                        </tr>
                                                        <tr *ngIf="expandedRow === i">
                                                            <td colspan="11" style="padding: 2%;">
                                                                <table style="width: 80%;">

                                                                    <tr style="background-color: transparent;">
                                                                        <td
                                                                            style="border: none;text-align: right;padding-top: 16px;">
                                                                            Fornecedor: </td>
                                                                        <td style="border: none;">
                                                                            <ng-select id="providerUid-{{ss.uid}}"
                                                                                [(ngModel)]="ss.providerUid"
                                                                                appendTo="body"
                                                                                placeholder='Fornecedor'>
                                                                                <ng-option *ngFor="let d of providers"
                                                                                    [value]="d.uid">
                                                                                    {{d?.nameCompany?.split('
                                                                                    ')[0]}}
                                                                                    {{(d?.nameCompany?.split(' ')[1]
                                                                                    !==
                                                                                    undefined ?
                                                                                    d?.nameCompany?.split(' ')[1] :
                                                                                    '')}}
                                                                                </ng-option>
                                                                            </ng-select>
                                                                        </td>
                                                                    </tr>
                                                                    <tr style="background-color: transparent;">
                                                                        <td
                                                                            style="border: none;text-align: right;;padding-top: 16px;">
                                                                            Nr da NF: </td>
                                                                        <td style="border: none;">
                                                                            <input type="text" name="purchaseNf"
                                                                                id="purchaseNf" class="form-control"
                                                                                [(ngModel)]="ss.purchaseNf"
                                                                                placeholder="Entre com a NF de Compra"
                                                                                maxlength="17">
                                                                        </td>
                                                                    </tr>
                                                                    <tr style="background-color: transparent;">
                                                                        <td
                                                                            style="border: none;text-align: right;;padding-top: 16px;">
                                                                            Complemento Produto: </td>
                                                                        <td style="border: none;">
                                                                            <textarea class="form-control" rows="3"
                                                                                type="text" name="note" id="note"
                                                                                maxlength="1000"
                                                                                placeholder="observações"
                                                                                [(ngModel)]="ss.note"></textarea>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </ng-container>
                                                </tbody>
                                                <thead>
                                                    <tr>
                                                        <th colspan="2">Serviço</th>
                                                        <th style="text-align: center; max-width: 90px;">Previsto</th>
                                                        <!-- <th style="text-align: center; max-width: 90px;">Frete</th> -->
                                                        <th style="text-align: center; max-width: 90px;">Qtd</th>
                                                        <th style="text-align: center; max-width: 90px;">Custo Unit.
                                                            R$
                                                        </th>
                                                        <th style="text-align: center; max-width: 90px;">Valor Unit.
                                                            R$
                                                        </th>
                                                        <th style="text-align: center; max-width: 90px;">Desc Unit.
                                                            R$</th>
                                                        <th style="text-align: center; max-width: 90px;">Total R$
                                                        </th>
                                                        <th style="text-align: center; max-width: 30px;">Pós
                                                        </th>
                                                        <th style="text-align: center;width: 15%;"><i
                                                                (click)="repeatTechnician()" class="fa-solid fa-repeat"
                                                                style="cursor: pointer;"></i>
                                                            Técnico</th>
                                                        <th style="text-align: center;" *ngIf="this.edit">Ações</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <ng-container
                                                        *ngFor="let ss of servicess | productTypeFilter:2; let i = index">
                                                        <!-- Linha principal -->
                                                        <tr>

                                                            <td colspan="2">
                                                                <b>{{ss.product?.codeManufacturer}}</b> -
                                                                {{ss.product?.code}} -
                                                                {{ss.productName}}
                                                                <br />
                                                                <small *ngIf="ss.from != undefined">Fornecimento:
                                                                    {{ss.from}}</small>
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;">
                                                                <input type="text" [name]="'timeExpected' + ss.uid "
                                                                    [id]="'timeExpected' + ss.uid" class="form-control"
                                                                    [(ngModel)]="ss.timeExpected"
                                                                    placeholder="Entre com a Frete" matInput mask="Hh:m0">
                                                            </td>
                                                            <!-- <td style="text-align: end; max-width: 90px;">
                                                                <input type="text" [name]="'shippingValue' + ss.uid "
                                                                    [id]="'shippingValue' + ss.uid" class="form-control"
                                                                    [(ngModel)]="ss.shippingValue"
                                                                    placeholder="Entre com a Frete" currencyMask
                                                                    [options]="{ align:'right', thousands: '.', prefix: '', decimal: ',', allowNegative: 'false'}">
                                                            </td> -->
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="ss.productDiscount > 0">
                                                                {{ss.quantity | number:'1.2-2' }}
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="ss.productDiscount == 0">
                                                                <input type="text" [name]="'quantity' + ss.uid "
                                                                    [id]="'quantity' + ss.uid" class="form-control"
                                                                    [(ngModel)]="ss.quantity"
                                                                    placeholder="Entre com a quantidade" currencyMask
                                                                    [options]="{ align:'right', thousands: '.', prefix: '', decimal: ',', allowNegative: 'false'}">
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;">
                                                                <input type="text" [name]="'productPriceCost' + ss.uid "
                                                                    *ngIf="ss.productType === 2 || viewCost"
                                                                    [id]="'productPriceCost' + ss.uid"
                                                                    class="form-control"
                                                                    [(ngModel)]="ss.productPriceCost" currencyMask
                                                                    [options]="{ align:'right', thousands: '.', prefix: '', decimal: ',', allowNegative: 'false'}">
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="ss.productDiscount > 0">
                                                                {{ss.productPrice | number:'1.2-2' }}
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="ss.productDiscount == 0">
                                                                <input type="tel" [name]="'prices' + ss.uid "
                                                                    [id]="'prices' + ss.uid" class="form-control"
                                                                    [(ngModel)]="ss.productPrice" currencyMask
                                                                    [readOnly]="changePrice"
                                                                    [options]="{ align:'right', thousands: '.', prefix: 'R$', decimal: ',', allowNegative: 'false'}" />
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="order.orderOutSourcing === undefined">
                                                                <div *ngIf="ss.productDiscountPercentual">
                                                                    {{(ss.productDiscountPercentual ?
                                                                    (ss.productDiscount |
                                                                    number:'1.2-2')
                                                                    + '%' : 'R$ ' + (ss.productDiscount |
                                                                    number:'1.2-2')
                                                                    )}}
                                                                </div>

                                                                <input *ngIf="!ss.productDiscountPercentual" type="text"
                                                                    [name]="'productDiscount' + ss.uid "
                                                                    [id]="'productDiscount' + ss.uid"
                                                                    class="form-control"
                                                                    [(ngModel)]="ss.productDiscount" currencyMask
                                                                    (blur)="discountChange(ss)"
                                                                    [options]="{ align:'right', thousands: '.', prefix: 'R$', decimal: ',', allowNegative: 'false'}" />
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;"
                                                                *ngIf="order.orderOutSourcing !== undefined">
                                                                <input type="text" [name]="'productDiscount' + ss.uid "
                                                                    [id]="'productDiscount' + ss.uid"
                                                                    class="form-control"
                                                                    [(ngModel)]="ss.productDiscount" currencyMask
                                                                    (blur)="discountChange(ss)"
                                                                    [options]="{ align:'right', thousands: '.', prefix: 'R$', decimal: ',', allowNegative: 'false'}" />
                                                            </td>
                                                            <td style="text-align: end; max-width: 90px;">
                                                                <b>{{total(ss) | number:'1.2-2'}}</b>
                                                            </td>
                                                            <td style="text-align: end;max-width: 90px;">
                                                                <input type="number" [name]="'frequency' + ss.uid "
                                                                    [id]="'frequency' + ss.uid" class="form-control"
                                                                    [(ngModel)]="ss.frequency"
                                                                    placeholder="Entre com a quantidade dias">
                                                            </td>
                                                            <td style="padding: 0px;">
                                                                <ng-select id="technicianUid-{{ss.uid}}"
                                                                    (change)="changeTechnician(ss)" name="technicianUid"
                                                                    [(ngModel)]="ss.technicianUid" appendTo="body"
                                                                    placeholder='Técnico'>
                                                                    <ng-option *ngFor="let d of technicals"
                                                                        [value]="d.uid">
                                                                        {{d?.nameCompany?.split(' ')[0]}}
                                                                        {{(d?.nameCompany?.split(' ')[1] !==
                                                                        undefined ?
                                                                        d?.nameCompany?.split(' ')[1] : '')}}
                                                                        <!-- {{d.cnpjCpf | mask:
                                                                    'CPF_CNPJ'}} -->
                                                                    </ng-option>
                                                                </ng-select>
                                                            </td>
                                                            <td style="text-align: center;">
                                                                <i class="fas fa-arrow-alt-circle-up btnAction"
                                                                    *ngIf="expandedRow === i+1000"
                                                                    (click)="toggleExpand(i+1000)">&nbsp;</i>

                                                                <i class="fas fa-arrow-alt-circle-down btnAction"
                                                                    *ngIf="expandedRow !==  i+1000"
                                                                    (click)="toggleExpand(i+1000)">&nbsp;</i>

                                                                <i class="fas fa-trash-alt btnAction"
                                                                    (click)="delete(ss)" *ngIf="this.edit"></i>&nbsp;
                                                                <i class="fas fa-thumbs-down btnAction"
                                                                    *ngIf="!ss.approved"
                                                                    (click)="this.edit ? ss.approved = true : return"
                                                                    data-toggle="tooltip" data-placement="top"
                                                                    title="Não Aprovado" style="color: red;"></i>
                                                                <i class="fas fa-thumbs-up btnAction"
                                                                    *ngIf="ss.approved" (click)="notApproved(ss)"
                                                                    data-toggle="tooltip" data-placement="top"
                                                                    title="Aprovado" style="color: green;"></i>
                                                            </td>

                                                        </tr>
                                                        <tr *ngIf="expandedRow === i+1000">
                                                            <td colspan="11" style="padding: 2%;">
                                                                <table style="width: 80%;">

                                                                    <tr style="background-color: transparent;">
                                                                        <td
                                                                            style="border: none;text-align: right;padding-top: 16px;">
                                                                            Fornecedor: </td>
                                                                        <td style="border: none;">
                                                                            <ng-select id="providerUid-{{ss.uid}}"
                                                                                [(ngModel)]="ss.providerUid"
                                                                                appendTo="body"
                                                                                placeholder='Fornecedor'>
                                                                                <ng-option *ngFor="let d of providers"
                                                                                    [value]="d.uid">
                                                                                    {{d?.nameCompany?.split('
                                                                                    ')[0]}}
                                                                                    {{(d?.nameCompany?.split(' ')[1]
                                                                                    !==
                                                                                    undefined ?
                                                                                    d?.nameCompany?.split(' ')[1] :
                                                                                    '')}}
                                                                                </ng-option>
                                                                            </ng-select>
                                                                        </td>
                                                                    </tr>
                                                                    <tr style="background-color: transparent;">
                                                                        <td
                                                                            style="border: none;text-align: right;;padding-top: 16px;">
                                                                            Nr da NF: </td>
                                                                        <td style="border: none;">
                                                                            <input type="text" name="purchaseNf"
                                                                                id="purchaseNf" class="form-control"
                                                                                [(ngModel)]="ss.purchaseNf"
                                                                                placeholder="Entre com o NF de Compra"
                                                                                maxlength="17">
                                                                        </td>
                                                                    </tr>
                                                                    <tr style="background-color: transparent;">
                                                                        <td
                                                                            style="border: none;text-align: right;;padding-top: 16px;">
                                                                            Complemento Serviço: </td>
                                                                        <td style="border: none;">
                                                                            <textarea class="form-control" rows="3"
                                                                                type="text" name="note" id="note"
                                                                                maxlength="1000"
                                                                                placeholder="observações"
                                                                                [(ngModel)]="ss.note"></textarea>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </ng-container>
                                                    <tr style="background-color: #0077ff4d;"
                                                        *ngIf="order.insurerPersonUid !== order.clientUid">
                                                        <td><b>TOTAL</b></td>
                                                        <td style="text-align: end;" colspan="2">
                                                            <b>Custo Serv R$: {{totalCostp(2) |
                                                                number:'1.2-2'}}</b><br>
                                                            <b *ngIf="viewCost">Custo Peça R$: {{totalCostp(1) |
                                                                number:'1.2-2'}}</b><br />
                                                            <b *ngIf="viewCost">Total Custo R$:
                                                                {{totalCostp(2)+totalCostp(1) |
                                                                number:'1.2-2'}}</b><br>
                                                        </td>
                                                        <td style="text-align: end;" colspan="3">
                                                            <b>Venda Serv R$: {{totalp(2) | number:'1.2-2'}}</b><br>
                                                            <b>Venda Peça R$: {{totalp(1) | number:'1.2-2'}}</b><br>
                                                            <b>Venda Total R$: {{totalp() | number:'1.2-2'}}</b><br>
                                                        </td>
                                                        <td></td>
                                                        <td>
                                                            <b *ngIf="viewCost">Lucro R$:
                                                                {{totalp()-(totalCostp(2)+totalCostp(1)) |
                                                                number:'1.2-2'}}</b><br>
                                                            <b *ngIf="viewCost">Lucro %:
                                                                {{(totalp()-(totalCostp(2)+totalCostp(1)))/totalp()*100
                                                                |
                                                                number:'1.2-2'}}</b><br>
                                                        </td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                </tbody>
                                                <tfoot>
                                                    <tr style="background-color: #0077ff4d;"
                                                        *ngIf="order.insurerPersonUid === order.clientUid">
                                                        <td><b>TOTAL</b></td>
                                                        <td style="text-align: end;" colspan="2">
                                                            <b>Custo Serv R$: {{totalCostp(2) |
                                                                number:'1.2-2'}}</b><br>
                                                            <b *ngIf="viewCost">Custo Prod R$: {{totalCostp(1) |
                                                                number:'1.2-2'}}</b>

                                                        </td>
                                                        <td style="text-align: end;" colspan="3">
                                                            <b>Produtos R$: {{totalp(1) | number:'1.2-2'}}</b><br>
                                                            <b>Serviços R$: {{totalp(2) | number:'1.2-2'}}</b><br>
                                                            <b>Serviços-Franquia R$: {{totalp(2)-totalFran() |
                                                                number:'1.2-2'}}</b><br>
                                                            <hr />
                                                            <h6>Seguro</h6>
                                                            <b *ngIf="totalFran() !== 0" style="color:red">Franquia
                                                                R$:
                                                                {{totalFran() | number:'1.2-2'}}<br></b>
                                                            <b *ngIf="(totalp(2)-totalFran()) < 0"
                                                                style="{{(totalp(2)+totalFran()) < 0 ? 'color:red': ''}}">Saldo
                                                                Franquia a descontar em produtos:
                                                                {{totalp(2)-totalFran()-totalF() |
                                                                number:'1.2-2'}}<br></b>
                                                            <hr />
                                                            <b>Total R$: {{totalp(1)+totalp(2)-totalFran() |
                                                                number:'1.2-2'}}</b><br>
                                                        </td>
                                                        <td></td>
                                                        <td>
                                                        </td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                </tfoot>
                                            </table>

                                        </div>
                                        <div class="form-group">
                                            <div class="accordion" id="accordionExampleDesription">
                                                <div class="card"
                                                    style="background-color: transparent; box-shadow: none;">
                                                    <div class="card-header" id="headingOne"
                                                        style="background-color: transparent; padding: 0; border: none;">
                                                        <h2 class="mb-0">
                                                            <button class="btn btn-link btn-block text-left"
                                                                type="button"
                                                                style="color: #000; text-transform: uppercase;font-weight: 800;"
                                                                data-toggle="collapse"
                                                                [attr.data-target]="'#collapseOne1'"
                                                                aria-expanded="true"
                                                                [attr.aria-controls]="'collapseOne1'">
                                                                <i class="far fa-clipboard      "></i> Descrição
                                                                Complementar:
                                                            </button>
                                                        </h2>
                                                    </div>

                                                    <div [id]="'collapseOne1'" class="collapse"
                                                        aria-labelledby="headingOne"
                                                        data-parent="#accordionExampleDesription">
                                                        <div class="card-body"
                                                            style="padding: 1px 0; margin-left: 35px;text-transform: uppercase;"
                                                            [innerHTML]="order.description"></div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="custom-tabs-docs" role="tabpanel"
                                        aria-labelledby="custom-tabs-docs-tab">
                                        <div class="card card-secondary">
                                            <div class="form-group">
                                                <div class="card-body">
                                                    <div class="form-group col-12">
                                                        <input #myInput name="imageUrl" id="imageUrl"
                                                            class="form-control" type="file"
                                                            accept=".jpg,.jpeg,.gif,.png,.pdf,.doc,.docx,.xls,.xlsx,.txt"
                                                            (change)="handleInputChangeDoc($event)" />
                                                    </div>
                                                </div>
                                                <div class="form-group col-12">
                                                    <div class="form-group col-12">
                                                        <table id="example1" class="table table-bordered table-striped">
                                                            <thead>
                                                                <tr>
                                                                    <th colspan="2">Arquivos</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr *ngFor="let pt of order.orderMedias"
                                                                    style="{{pt.type === 'img' ? 'display:none' : ''}}">

                                                                    <td style="cursor: pointer;" data-toggle="modal"
                                                                        (click)="openFile(pt.name)"
                                                                        data-target="#modal-preview-pdf">
                                                                        {{pt.description}}
                                                                    </td>
                                                                    <td>custom-tabs-docs
                                                                        <a href="{{urlCdn + pt.name}}"
                                                                            target="_blank"><i
                                                                                class="fas fa-download btnAction"></i></a>&nbsp;
                                                                        <i class="fas fa-trash-alt btnAction"
                                                                            (click)="onRemove(pt)"></i>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="custom-tabs-images" role="tabpanel"
                                    aria-labelledby="custom-tabs-insumos-images-tab">
                                        <ul class="accordion" >
                                            <li *ngIf="mediasCheckIn.length > 0">
                                                <div class="accordion-header" (click)="toggleAccordion('Checkin')">
                                                    <span>{{ openedMedia === 'Checkin' ? '−' : '+' }}</span>
                                                    Check-in
                                                </div>
                                                <div class="accordion-body">
                                                    <table class id="example1" class="table table-bordered table-striped" *ngIf="openedMedia === 'Checkin'">
                                                        <thead>
                                                            <tr>
                                                                <th>Fotos</th>
                                                                <th>Descrição</th>
                                                                <th style="text-align: center;" *ngIf="this.edit">Ações</th>
                                                             </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr *ngFor="let pt of mediasCheckIn"
                                                                style="{{pt.type !== 'img' ? 'display:none' : ''}}">

                                                                <td style="text-align: center;">
                                                                    <img-minio [fileName]="pt.name"
                                                                    [style]="'max-width: 100px'"></img-minio>
                                                                </td>
                                                                <td>
                                                                    {{pt.description}}
                                                                </td>
                                                                <td style="text-align: center;" *ngIf="this.edit">
                                                                    <i class="fas fa-trash-alt btnAction"
                                                                        (click)="onRemove(pt)"></i>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </li>
                                            <li *ngIf="mediasDuring.length > 0">
                                                <div class="accordion-header" (click)="toggleAccordion('During')">
                                                    <span>{{ openedMedia === 'During' ? '−' : '+' }}</span>
                                                    Em andamento
                                                </div>
                                                <div>
                                                    <table id="example1" class="table table-bordered table-striped" *ngIf="openedMedia === 'During'">
                                                        <thead>
                                                            <tr>
                                                                <th>Fotos</th>
                                                                <th>Descrição</th>
                                                                <th style="text-align: center;" *ngIf="this.edit">Ações</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr *ngFor="let pt of mediasDuring"
                                                                style="{{pt.type !== 'img' ? 'display:none' : ''}}">
                                                            
                                                                <td style="text-align: center;">
                                                                    <img-minio [fileName]="pt.name"
                                                                        [style]="'max-width: 100px'"></img-minio>
                                                                </td>
                                                                <td>
                                                                    {{pt.description}}
                                                                </td>
                                                                <td style="text-align: center;" *ngIf="this.edit">
                                                                    <i class="fas fa-trash-alt btnAction"
                                                                        (click)="onRemove(pt)"></i>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </li>
                                            <li *ngIf="mediasCheckout.length > 0">
                                                <div class="accordion-header" (click)="toggleAccordion('Checkout')">
                                                    <span>{{ openedMedia === 'Checkout' ? '−' : '+' }}</span>
                                                    Check-out
                                                </div>
                                                <div>
                                                    <table id="example1" class="table table-bordered table-striped" *ngIf="openedMedia === 'Checkout'">
                                                        <thead>
                                                            <tr>
                                                                <th>Fotos</th>
                                                                <th>Descrição</th>
                                                                <th style="text-align: center;" *ngIf="this.edit">Ações</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr *ngFor="let pt of mediasCheckout"
                                                                style="{{pt.type !== 'img' ? 'display:none' : ''}}">
                                                            
                                                                <td style="text-align: center;">
                                                                    <img-minio [fileName]="pt.name"
                                                                    [style]="'max-width: 100px'"></img-minio>
                                                                </td>
                                                                <td>
                                                                    {{pt.description}}
                                                                </td>
                                                                <td style="text-align: center;" *ngIf="this.edit">
                                                                    <i class="fas fa-trash-alt btnAction"
                                                                    (click)="onRemove(pt)"></i>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="tab-pane fade" id="custom-tabs-insumos" role="tabpanel"
                                        aria-labelledby="custom-tabs-insumos-insumos-tab">
                                        <div class="card card-secondary" style="margin-bottom: 230px;">
                                            <table id="example1" class="table table-bordered table-striped">
                                                <thead>
                                                    <tr>
                                                        <th colspan="7 " *ngIf="this.edit">
                                                            <button class="btn btn-primary" style="float: right;"
                                                            (click)="addProductInpust()">Adicionar
                                                            Insumo</button>
                                                        </th>
                                                    </tr>
                                                    <tr>
                                                        <td style="text-align: right;width: 70%; padding-top: 10px;"
                                                            colspan="5">
                                                            Quantidade de Peças pintadas
                                                        </td>
                                                        <td>
                                                            <input type="number" name="paintedParts" id="paintedParts"
                                                                class="form-control" max="100" min="0"
                                                                [(ngModel)]="order.paintedParts" />
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="text-align: right;width: 70%; padding-top: 10px;"
                                                            colspan="5">
                                                            Custo por Peça Pintada R$
                                                        </td>
                                                        <td style="text-align: right">
                                                            {{getTotalInpust()/order.paintedParts | number:
                                                            '1.4-4'}}
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th>Produto</th>
                                                        <th>Qtd</th>
                                                        <th>Unidade</th>
                                                        <th>Custo R$</th>
                                                        <th>Total R$</th>
                                                        <th>Técnico</th>
                                                        <th style="width:5%;">Ações</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let s of productInputs; let ij = index">

                                                        <td>
                                                            <ng-select [id]="'product' + ij" [name]="'product' + ij"
                                                                [(ngModel)]="s.productUid" (change)="getPrice(s)"
                                                                placeholder="Selecione aqui produto ou serviço"
                                                                appendTo="body">
                                                                <ng-option *ngFor="let s of productsInputs"
                                                                    [value]="s.uid">
                                                                    {{s.codeManufacturer}}{{s.codeManufacturer !=
                                                                    null ?
                                                                    '-' : ''}}{{s.name}} </ng-option>
                                                            </ng-select>
                                                        </td>
                                                        <td class="navbar-btn sidebar-toggle" data-toggle="offcanvas"
                                                            role="button" data-tooltip="tooltip">
                                                            <input type="text" [name]="'quantity' + ij "
                                                                [id]="'quantity' + ij" class="form-control"
                                                                [(ngModel)]="s.quantity"
                                                                placeholder="Entre com a quantidade" currencyMask
                                                                [options]="{ align:'right', precision: 2, thousands: '.', prefix: '', decimal: ',', allowNegative: 'false'}">
                                                                
                                                            </td>
                                                        <td>
                                                            {{getUnity(s)}}
                                                            {{s.unity}}
                                                        </td>
                                                        <td style="text-align: right;">
                                                            {{s.productPriceCost | number: '1.4-4'}}
                                                        </td>
                                                        <td style="text-align: right;">
                                                            {{s.productPriceCost*s.quantity | number: '1.4-4'}}
                                                        </td>
                                                        <td style="text-align: right;">
                                                            <ng-select id="technicianUid-{{ij}}"
                                                                (change)="changeTechnician(s)" name="technicianUid"
                                                                [(ngModel)]="s.technicianUid" appendTo="body"
                                                                placeholder='Técnico'>
                                                                <ng-option *ngFor="let d of technicals" [value]="d.uid">
                                                                    {{d?.nameCompany?.split(' ')[0]}}
                                                                    {{(d?.nameCompany?.split(' ')[1] !== undefined ?
                                                                    d?.nameCompany?.split(' ')[1] : '')}}
                                                                </ng-option>
                                                            </ng-select>
                                                        </td>
                                                        <td>
                                                            <i class="fas fa-trash btnAction" *ngIf="this.edit"
                                                                (click)="deleteProductInpust(s)" data-toggle="tooltip"
                                                                data-placement="top" title="Cancelar Os"></i>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                                <tfoot>
                                                    <tr>
                                                        <td colspan="4" style="text-align: right;">
                                                            Total R$
                                                        </td>
                                                        <td style="text-align: right;">
                                                            {{getTotalInpust() | number: '1.4-4'}}
                                                        </td>
                                                        <td style="text-align: right;">
                                                            &nbsp;
                                                        </td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="tab-pane fade" id="custom-tabs-taximetro" role="tabpanel"
                                        aria-labelledby="custom-tabs-taximetro-tab">
                                        <div class="row">
                                            <button class="btn btn-secondary" style="margin: 0px 4px;float: right;"
                                                *ngIf="order !== undefined" (click)="openOsTaximeter()">Imprimir
                                                Guia</button>
                                        </div>
                                        <div class="col-md-12">

                                            <div class="form-group">
                                                <label for="carPrefix">Prefixo</label>
                                                <input type="text" name="carPrefix" id="carPrefix"
                                                    [(ngModel)]="order.carPrefix" class="form-control" placeholder=""
                                                    maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carTire">Pneu</label>
                                                <input type="text" name="carTire" id="carTire"
                                                    [(ngModel)]="order.carTire" class="form-control" placeholder=""
                                                    maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carPounds">PSI</label>
                                                <input type="text" name="carPounds" id="carPounds"
                                                    [(ngModel)]="order.carPounds" class="form-control" placeholder=""
                                                    maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carBrandTaximeter">Marca</label>
                                                <input type="text" name="carBrandTaximeter" id="carBrandTaximeter"
                                                    [(ngModel)]="order.carBrandTaximeter" class="form-control"
                                                    placeholder="" maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carModelTaximeter">Modelo</label>
                                                <input type="text" name="carModelTaximeter" id="carModelTaximeter"
                                                    [(ngModel)]="order.carModelTaximeter" class="form-control"
                                                    placeholder="" maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carConcierge">Portaria</label>
                                                <input type="text" name="carConcierge" id="carConcierge"
                                                    [(ngModel)]="order.carConcierge" class="form-control" placeholder=""
                                                    maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carBrandStampOut">Marca Selagem Retirado</label>
                                                <input type="text" name="carBrandStampOut" id="carBrandStampOut"
                                                    [(ngModel)]="order.carBrandStampOut" class="form-control"
                                                    placeholder="" maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carBrandStampIn">Marca Selagem Colocado</label>
                                                <input type="text" name="carBrandStampIn" id="carBrandStampIn"
                                                    [(ngModel)]="order.carBrandStampIn" class="form-control"
                                                    placeholder="" maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carBrandRepairOut">Marca Reparo Retirado</label>
                                                <input type="text" name="carBrandRepairOut" id="carBrandRepairOut"
                                                    [(ngModel)]="order.carBrandRepairOut" class="form-control"
                                                    placeholder="" maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carBrandRepairIn">Marca Reparo Colocado</label>
                                                <input type="text" name="carBrandRepairIn" id="carBrandRepairIn"
                                                    [(ngModel)]="order.carBrandRepairIn" class="form-control"
                                                    placeholder="" maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carNrSerie">Nrº de Série</label>
                                                <input type="text" name="carNrSerie" id="carNrSerie"
                                                    [(ngModel)]="order.carNrSerie" class="form-control" placeholder=""
                                                    maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carMnrInmetro">Nrº Inmetro</label>
                                                <input type="text" name="carMnrInmetro" id="carMnrInmetro"
                                                    [(ngModel)]="order.carMnrInmetro" class="form-control"
                                                    placeholder="" maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carCoefficient">Coeficiente W</label>
                                                <input type="text" name="carCoefficient" id="carCoefficient"
                                                    [(ngModel)]="order.carCoefficient" class="form-control"
                                                    placeholder="" maxlength="255">
                                            </div>
                                            <div class="form-group">
                                                <label for="carSerieModuleInspection">Série Modulo Inspeção</label>
                                                <input type="text" name="carSerieModuleInspection"
                                                    id="carSerieModuleInspection " class="form-control"
                                                    [(ngModel)]="order.carSerieModuleInspection">
                                            </div>
                                            <div class="form-group">
                                                <label for="carNrSerieBeltMagnetic">Série Cinta Magnética</label>
                                                <input type="text" name="carNrSerieBeltMagnetic"
                                                    id="carNrSerieBeltMagnetic" class="form-control"
                                                    [(ngModel)]="order.carNrSerieBeltMagnetic">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- /.card -->
                        </div>
                        <!-- /.card-body -->
                        <div class="card-footer">



                            <button class="btn btn-secondary" *ngIf="order.status === 'Concluído'"
                                (click)="saveInternalCommentary()">Salvar</button>

                            <button class="btn btn-primary" *ngIf="this.ordering" (click)="status()">Salvar</button>

                            <button class="btn btn-primary" *ngIf="this.saving" (click)="save()">Salvar</button>


                            <button class="btn btn-success" *ngIf="this.done" (click)="status()"
                                style="float: right;margin-left: 5px;">Concluir</button>

                            <button class="btn btn-warning" *ngIf="this.onAprove" (click)="status()"
                                style="float: right;margin-left: 5px;">Pedir aprovação</button>
                            <button class="btn btn-success" *ngIf="this.aproved" (click)="status()"
                                style="float: right;margin-left: 5px;">Aprovar</button>

                            <button class="btn btn-info" *ngIf="this.doing || this.book" (click)="status()"
                                style="float: right;margin-left: 5px;">Em
                                andamento</button>
                            <button class="btn btn-warning" *ngIf="this.book" (click)="status(true)"
                                style="float: right;">Agendar</button>

                            <input type="datetime-local" name="bookDate" *ngIf="this.book || this.doing" id="bookDate"
                                min="a" style="margin-right: 5px;margin-left: 5px;"
                                class="col-3 float-right form-control"
                                [ngModel]="order.bookedDate | date:'yyyy-MM-ddTHH:mm:ss' "
                                (ngModelChange)="order.bookedDate = $event">

                            <button class="btn btn-danger" *ngIf="osReopen && this.cancel" style="margin-left: 5px;
                                float: right;" (click)="deny()">Cancelar</button>

                            <button class="btn btn-secondary" style="margin: 0px 4px;float: right;"
                                *ngIf="order !== undefined" (click)="openOs()">Imprimir</button>

                            <button class="btn btn-secondary" style="margin: 0px 4px;float: right;"
                                *ngIf="order.orderOutSourcing !== undefined" (click)="openCiliaOs()">Imprimir
                                CILIA</button>

                            <button class="btn btn-success" *ngIf="verifyPhone()" (click)="openWhatsapp()"
                                style="float: right;">
                                <img src="https://cdn-icons-png.flaticon.com/128/1384/1384055.png" style="
                                zoom: 0.17;
                                margin-top: -15px;" /> Enviar OS</button>

                            <button class="btn btn-success" style="margin: 0px 4px;float: right;"
                                *ngIf="order.status === 'Concluído' && order.invoice === undefined && billing()"
                                (click)="openBilling()">FATURAMENTO</button>

                            <button class="btn btn-secondary" (click)="back()" style="margin-left: 5px;">Voltar</button>

                            <button class="btn btn-secondary" style="margin-left: 5px;"
                                *ngIf="order !== undefined && viewCost" (click)="openOs(1)">Imprimir com
                                Custo</button>

                            <button class="btn btn-secondary" style="margin-left: 5px;"
                                *ngIf="order !== undefined && viewCost" (click)="openCategory(1)">Imprimir por
                                Categoria</button>
                            &nbsp;

                        </div>
                    </div>
                    <!-- /.card -->
                </div>
                <!--/.col (left) -->
                <!-- right column -->
                <div class="col-md-6">

                </div>
                <!--/.col (right) -->
            </div>
        </div>
        <!-- /.row -->
    </section>
</div>

<div class="shadow" *ngIf="this.showConfirm">
    <div class="form">
        <div style="display: flex; width: 100%; justify-content: center;">
            <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 16px;">Qual momento você tirou a foto?</h3>
            <button (click)="onChooseMoment('cancel')" class="btn btn-secondary" style="position: absolute; right: 10px; height: 33px; text-box-trim: trim-start;">X</button>
        </div>
        
        <div style="display: flex; flex-direction: row; justify-content: center; width: 100%; gap: 30px;">
            <button (click)="onChooseMoment(0)" class="btn btn-primary">CheckIn</button>
            <button (click)="onChooseMoment(null)" class="btn btn-secondary">Em andamento</button>
            <button (click)="onChooseMoment(1)" class="btn btn-success">CheckOut</button>
        </div>
    </div>
</div>
<app-modal-new-user [persons]="clients" (onNew)="newUser($event)"></app-modal-new-user>
<!-- <app-modal-plate-edit [(plate)]="order.plateM"></app-modal-plate-edit> -->
