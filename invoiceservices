import { Component, OnInit } from '@angular/core';
import { ActivatedRoute, Router } from '@angular/router';


import { ApiClientService } from '@app/@shared/services/api-client.service';
import { environment } from '@environments/environment';
import { ToastrService } from 'ngx-toastr';

@Component({
  selector: 'app-checklist-print',
  templateUrl: './checklist-print.component.html',
  styleUrls: ['./checklist-print.component.css']
})
export class ChecklistPrintComponent implements OnInit {

  business: any = {};
  urlCdn = environment.urls.cdn + 'imgs/';
  check: any  = {};
  questions: any[] = [];
  address: string = '';
  name: string = '';
  constructor(
    private apiClientService: ApiClientService,
    private toastr: ToastrService,
    private route: ActivatedRoute,
    private router: Router
  ) { }

  ngOnInit(): void {
    this.check.uid = this.route.snapshot.params['uid'];
    this.apiClientService.getPath(environment.urls.api, "checklist/uid/" + this.check.uid).then((data: any ) => {
      this.check = data.response;
      this.name = data.name;
      if (this.check.person?.addressStreet !== null && this.check.person?.addressStreet?.length > 0) {
        this.address += this.check.person?.addressNumber + ' - ' + this.check.person?.addressStreet + ' - ' + this.check.person?.addressDistrict;
        this.address += ' - ' + this.check.person?.addressCity + this.check.person?.addressState + ' - ' + this.check.person?.addressZipCode;
      }
      this.business = data.response.business;
      
      var i = 0;
      this.check.question.split('|').forEach(element => {
        const a1 = {
          question: element,
          respose: this.check.response.split('|')[i],
          note: '',
          image:  this.check.image.split('|')[i],
        } as unknown as any;

        this.questions.push(a1);
        i++;
      });
    });
  }

}
