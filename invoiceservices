namespace Front.API.Controllers
{
    using System;
    using System.Collections.Generic;
    using System.Threading.Tasks;
    using global::Core.BC.Domain.Entities.checklistConfig;
    using global::Core.BC.Domain.Entities.checklistConfig.Commands;
    using global::Core.BC.Domain.Entities.checklistConfig.interfaces;
    using Interanet.Commons.Core.Shared.Interfaces;
    using Interanet.Commons.Core.Shared.Messages;
    using Interanet.Commons.Front.Shared.Base;
    using MediatR;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.Extensions.Logging;
    using Swashbuckle.AspNetCore.Annotations;

    [Route("~/checklistConfig")]
    [ApiExplorerSettings(GroupName = @"checklistConfig")]
    [SwaggerTag("Api da Empresa.")]
    public class ChecklistConfigController : DefaultControllerAbstract<ChecklistConfigModel>
    {
        public ChecklistConfigController(
            IAppService<ChecklistConfigModel> service,
            ILogger<ChecklistConfigModel> logger,
            INotificationHandler<Notification> notification)
            : base(service, logger, notification)
        {
            service.EnableUserAcl = true;
        }

        [HttpPost]
        [SwaggerOperation(
        Summary = "Insere  um novo registro",
        Description = "")]
        public async Task<IActionResult> Create(ChecklistConfigBaseCommand cmd)
        {
            var response = await this.service.Create(cmd);

            return this.Response(response.IsValid ? response.Data : null, null, null);

        }

        [HttpGet]
        [Route("all")]
        public async Task<IActionResult> All()
        {
            var app = (IchecklistConfigServices)this.service;
            var response = app.GetAll();
            return this.Response(response, null);
        }

        [HttpPut]
        [SwaggerOperation(
        Summary = "Atualiza um registro",
        Description = ".")]
        public async Task<IActionResult> Update(ChecklistConfigModel cmd)
        {

            var app = (IchecklistConfigServices)this.service;
            var response = await app.Update(cmd);

            return this.Response(true);
        }

        [HttpPost]
        [Route("search")]
        [SwaggerOperation(
       Summary = "Pesquisar",
       Description = "Pesquisa de forma paginada ...")]
        [SwaggerResponse(404, "Não há nenhum objeto cadastrado para este recurso.", null)]
        [SwaggerResponse(200, "Ação realizada com sucesso.", typeof(ResponsePaginated<List<ChecklistConfigModel>>))]
        public virtual async Task<IActionResult> Search(
           [FromBody] ChecklistConfigListCommand cmd,
           [FromHeader] int pageSize = 10,
           [FromHeader] int page = 1,
           [FromHeader] string order = "asc",
           [FromHeader] string columnOrder = "Title"
           )
        {
            cmd.PageSize = pageSize;
            cmd.Order = order;
            cmd.ColumnOrder = columnOrder;
            var app = (IchecklistConfigServices)this.service;
            var response = await app.Search(cmd);
            return this.Response(response.IsValid ? response : null, nameof(this.GetById), null);
        }

        [HttpGet]
        [Route("parent/{uid}")]
        [SwaggerOperation(
       Summary = "Pesquisar",
       Description = "Pesquisa de forma paginada ...")]
        [SwaggerResponse(404, "Não há nenhum objeto cadastrado para este recurso.", null)]
        [SwaggerResponse(200, "Ação realizada com sucesso.", typeof(ResponsePaginated<List<ChecklistConfigModel>>))]
        public IActionResult ByPerson(
           [FromHeader] Guid businessUid,
           [FromRoute] Guid uid,
           [FromHeader] string order = "asc",
           [FromHeader] string columnOrder = "name"
           )
        {
            var cmd = new ChecklistConfigListCommand();
            cmd.Order = order;
            cmd.Uid = uid;
            cmd.ColumnOrder = columnOrder;
            var app = (IchecklistConfigServices)this.service;
            var response = app.Parent(cmd);
            return this.Response(response);
        }

    }
}
